<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Game Release Calendar</title>
    <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Arial', sans-serif; background: #f4f4f4; margin: 0; padding: 20px; }
        .calendar-container { max-width: 800px; margin: auto; }
        .calendar { background: white; padding: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .game-details { margin-top: 20px; background: #fff; padding: 20px; display: none; }
        .game-preview { cursor: pointer; }
        .wishlist-btn, .reminder-btn { cursor: pointer; color: blue; text-decoration: underline; }
        .modal { display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.4); }
        .modal-content { background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 500px; }
    </style>
</head>
<body>

<div class="calendar-container">
    <div id="calendar"></div>
    <div class="game-details" id="gameDetails"></div>
</div>

<div class="modal" id="gameModal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <div id="modalContent"></div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', (event) => {
    const calendar = flatpickr("#calendar", {
      inline: true,
      onChange: function(selectedDates, dateStr, instance) {
        const gameForDate = games.find(game => game.releaseDate === dateStr);
        if (gameForDate) {
          displayGameDetails(gameForDate);
        } else {
          $("#gameDetails").hide();
        }
      }
    });

    const games = [
      {name: "Cyberpunk 2078", releaseDate: "2023-12-10", id: 1},
      {name: "Elden Ring: Shadow of the Erdtree", releaseDate: "2023-11-25", id: 2},
      // More games would be fetched from an API here
    ];

    function displayGameDetails(game) {
      $("#gameDetails").html(`
            <h2>${game.name}</h2>
            <p>Release Date: ${game.releaseDate}</p>
            <p class="game-preview" onclick="showPreview(${game.id})">Preview</p>
            <p class="wishlist-btn" onclick="addToWishlist(${game.id})">Add to Wishlist</p>
            <p class="reminder-btn" onclick="setReminder('${game.name}', '${game.releaseDate}')">Set Reminder</p>
        `).show();
    }

    function showPreview(id) {
      // Here you would fetch game preview content or video
      $("#modalContent").html(`Preview for game with id: ${id}`);
      $("#gameModal").show();
    }

    $(".close").on('click', function() {
      $("#gameModal").hide();
    });

    window.addToWishlist = function(id) {
      let wishlist = JSON.parse(localStorage.getItem('gameWishlist') || "[]");
      if (!wishlist.includes(id)) {
        wishlist.push(id);
        localStorage.setItem('gameWishlist', JSON.stringify(wishlist));
        alert('Added to wishlist!');
      } else {
        alert('Already in wishlist!');
      }
    };

    window.setReminder = function(name, date) {
      if ('Notification' in window) {
        if (Notification.permission === "granted") {
          new Notification(`Reminder: ${name} releases today!`);
        } else if (Notification.permission !== "denied") {
          Notification.requestPermission().then(function (permission) {
            if (permission === "granted") {
              new Notification(`Reminder set for ${name} on ${date}`);
            }
          });
        }
      }
    };
  });
</script>

</body>
</html>