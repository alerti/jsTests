<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Event Manager</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Arial', sans-serif; }
        .event-card { margin: 10px; }
        .card-img-top { height: 200px; object-fit: cover; }
        .wishlist-item { cursor: pointer; }
        .liked { color: red; }
    </style>
</head>
<body>

<div class="container mt-4">
    <h1>Event Explorer & Wishlist</h1>

    <!-- Filters and Search -->
    <div class="mb-3">
        <input class="form-control mb-2" id="searchInput" placeholder="Search events..." type="text">
        <select class="form-control mb-2" id="filterLocation">
            <option value="">All Locations</option>
            <!-- Options will be dynamically filled -->
        </select>
        <select class="form-control mb-2" id="filterCategory">
            <option value="">All Categories</option>
            <!-- Options will be dynamically filled -->
        </select>
        <button class="btn btn-info" onclick="sortEvents('date')">Sort by Date</button>
    </div>

    <!-- Events Section -->
    <div class="row" id="eventsContainer"></div>

    <!-- Pagination -->
    <nav aria-label="Event pagination">
        <ul class="pagination justify-content-center" id="pagination"></ul>
    </nav>

    <!-- Wishlist Section -->
    <h2>Wishlist</h2>
    <div class="row" id="wishlistContainer"></div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
  const events = [
    // Sample data as provided would be here or fetched from an API
  ];

  let currentPage = 1;
  const eventsPerPage = 4;
  let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];

  function renderEvents(page = 1) {
    const container = $('#eventsContainer');
    container.empty();
    const startIndex = (page - 1) * eventsPerPage;
    const endIndex = startIndex + eventsPerPage;
    const pageEvents = events.filter(event =>
      event.name.toLowerCase().includes($('#searchInput').val().toLowerCase()) &&
      (event.location === $('#filterLocation').val() || $('#filterLocation').val() === '') &&
      (event.category === $('#filterCategory').val() || $('#filterCategory').val() === '')
    ).slice(startIndex, endIndex);

    pageEvents.forEach(event => {
      const card = `
        <div class="col-md-6 event-card">
            <div class="card">
                <img src="${event.image}" class="card-img-top" alt="${event.name}">
                <div class="card-body">
                    <h5 class="card-title">${event.name}</h5>
                    <p><strong>Date:</strong> ${event.date} | <strong>Location:</strong> ${event.location}</p>
                    <p>${event.description}</p>
                    <button onclick="toggleLike(${event.id})" class="btn btn-outline-secondary">
                        <i class="fa ${event.liked ? 'fa-heart' : 'fa-heart-o'}"></i>
                    </button>
                    <button onclick="addToWishlist(${event.id})" class="btn btn-primary">Add to Wishlist</button>
                </div>
            </div>
        </div>`;
      container.append(card);
    });

    updatePagination();
  }

  function updatePagination() {
    const totalPages = Math.ceil(events.length / eventsPerPage);
    const pagination = $('#pagination');
    pagination.empty();
    for(let i = 1; i <= totalPages; i++) {
      pagination.append(`<li class="page-item ${currentPage === i ? 'active' : ''}"><a class="page-link" href="#" onclick="changePage(${i})">${i}</a></li>`);
    }
  }

  function changePage(page) {
    currentPage = page;
    renderEvents(page);
  }

  function toggleLike(id) {
    const index = events.findIndex(e => e.id === id);
    if(index !== -1) {
      events[index].liked = !events[index].liked;
      renderEvents(currentPage);
    }
  }

  function addToWishlist(id) {
    if(!wishlist.includes(id)) {
      wishlist.push(id);
      localStorage.setItem('wishlist', JSON.stringify(wishlist));
      renderWishlist();
    } else {
      alert('Event already in wishlist!');
    }
  }

  function renderWishlist() {
    const wishlistContainer = $('#wishlistContainer');
    wishlistContainer.empty();
    wishlist.forEach(id => {
      const event = events.find(e => e.id === id);
      if(event) {
        wishlistContainer.append(`
            <div class="col-md-3 wishlist-item" onclick="removeFromWishlist(${id})">
                <div class="card">
                    <img src="${event.image}" class="card-img-top" alt="${event.name}">
                    <div class="card-body">
                        <h5 class="card-title">${event.name}</h5>
                    </div>
                </div>
            </div>`);
      }
    });
  }

  function removeFromWishlist(id) {
    wishlist = wishlist.filter(item => item !== id);
    localStorage.setItem('wishlist', JSON.stringify(wishlist));
    renderWishlist();
    renderEvents(currentPage); // Refresh to update wishlist buttons
  }

  function sortEvents(by) {
    events.sort((a, b) => new Date(a[by]) - new Date(b[by]));
    renderEvents();
  }

  $(document).ready(function() {
    // Populate filters
    const locations = [...new Set(events.map(e => e.location))];
    const categories = [...new Set(events.map(e => e.category))];
    locations.forEach(loc => $('#filterLocation').append(`<option>${loc}</option>`));
    categories.forEach(cat => $('#filterCategory').append(`<option>${cat}</option>`));

    $('#searchInput, #filterLocation, #filterCategory').on('change keyup', function() {
      renderEvents(1);
    });

    renderEvents();
    renderWishlist();
  });
</script>
</body>
</html>